# Dependency Injection (의존성 주입)

## 의존성이란?
어떤 객체에 다른 객체가 쓰인다.

## 주입이란?
어떤 객체 내부에서 다른 객체를 생성하지 않고 외부에서 다른 객체를 넣는다.

## IoC  (Inversion of Control, 제어의 역전)
Dependency Container를 만들고 그 컨테이너에 의존성을 주입하여 다시 분배한다.

```typescript
interface Coffee {
  option: Record<string, any>;
  make(): void;
}

class Americano implements Coffee {
  option = {};

  public make() {
    console.log('아메리카노를 만들어요');
  }
}

class Order {
  // 문제
  // private coffee: Coffee;

  // constructor() {
  //   this.coffee = new Americano(); 
  // }

  // public make() {
  //   this.coffee.make();
  // }

  // 해결
  constructor(private coffee: Coffee) {}

  public make() {
    this.coffee.make();
  }
}

const order = new Order();
order.make();

// 문제점: Order는 주문하기 이지만 Americano라는 클래스에 의존하게 되어 AmericanoOrder로 이름 변경이 필요해보임
// 해결방법: new Order를 생성할 때 new Americano()를 같이 넘기기
```

```typescript
// DI를 사용할 때 생기는 문제
class Options {
  constructor() {
    // 생략
  }

  public static setDefaultOption() {
    return {
      shot: 2,
      isHot: true,
      extra: [],
      cup: 'mugcup',
    }
  }
}

class Order {
  options: Record<string, any>;
  
  constructor(private coffee: Coffee) {
    this.options = Options.setDefaultOption(); // Hidden Dependency가 생김
  }

  public make() {
    this.coffee.make();
  }
}

// 문제점: 개발자가 예측할 수 없는 숨은 의존성이 생김
// 해결방법: 예측 가능하도록 의존성을 주입하기 (IoC - Dependency Container를 새롭게 만든 뒤 Order의 의존성을 갖고 있도록 설정)
```
